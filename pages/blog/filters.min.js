"use strict";function a(e){return function(e){if(Array.isArray(e))return c(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return c(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Map"===(n="Object"===n&&e.constructor?e.constructor.name:n)||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?c(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function c(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var s,u="https://academy.directlinedev.com",d=document.querySelector(".blog-spinner_js.spinner_js");function m(t){var n=document.querySelector(".pagination-next_js"),a=document.querySelector(".pagination-prev_js");a.disabled=!1,n.disabled=!1;var c=h(),s=new URLSearchParams(location.search);0===c.page&&(a.disabled=!0),c.page>=t-1&&(n.disabled=!0),n.addEventListener("click",function(){a.disabled=!1;var e=+s.getAll("page");c=h(),t-1<=e?n.disabled=!0:(c.page=1+e,s.set("page",c.page),history.replaceState(null,document.title,"?"+s.toString()),p(h()),(c=h()).page>=t-1&&(n.disabled=!0))},{once:!0}),a.addEventListener("click",function(){n.disabled=!1;var e=+s.getAll("page");c=h(),0==e?a.disabled=!0:(c.page=e-1,s.set("page",c.page),history.replaceState(null,document.title,"?"+s.toString()),p(h()),0===(c=h()).page&&(a.disabled=!0))},{once:!0})}function p(i){var l=new XMLHttpRequest,e=new URLSearchParams(location.search);e.set("v","1.0.0"),i.tags&&Array.isArray(i.tags)&&i.tags.length&&e.set("tags",JSON.stringify(i.tags));var t,n,a,c,s={};i.comments.length&&(c=i.comments,t=[],n=[],c.forEach(function(e){t=t.concat(e.split("-"))}),t.forEach(function(e){n.push(+e)}),a=Math.min.apply(null,n),c=Math.max.apply(null,n),s.commentsCount={$between:[a,c]}),i.views.length&&(c=i.views.split("-"),s.views={$between:[+c[0],+c[1]]}),i.search&&(s.title=i.search),e.set("filter",JSON.stringify(s)),i.sort&&e.set("sort",JSON.stringify([i.sort,"ASC"])),e.set("limit",i.show),+i.page&&e.set("offset",+i.page*i.show),l.open("GET",u+"/api/posts?"+e.toString()),l.send(),d.classList.remove("hidden"),l.onload=function(){var e=JSON.parse(l.response).data,t=JSON.parse(l.response).count,n="",a=document.querySelector(".pagination__list");a.innerHTML="",e.forEach(function(e){n+=function(e){var t=e.title,n=e.text,a=e.views,c=e.photo,s=e.commentsCount,o=e.date,r=e.tags,i="";r.forEach(function(e){i+='<span class="article__tags_color" style="background:'.concat(e.color,'"></span>')});e=new Date(o),r=e.getDate()<10?"0"+e.getDate():e.getDate(),o=e.getMonth()<10?"0"+e.getMonth():e.getMonth(),e="".concat(r,".").concat(o,".").concat(e.getFullYear());return'\n    <article class="article">\n    <picture>\n        <source srcset="'.concat(u).concat(c.mobilePhotoUrl,", ").concat(u).concat(c.mobile2xPhotoUrl,' 2x" media="(max-width: 375px)">\n        <source srcset="').concat(u).concat(c.tabletPhotoUrl,", ").concat(u).concat(c.tablet2xPhotoUrl,' 2x" media="(max-width: 768px)">\n        <source srcset="').concat(u).concat(c.desktopPhotoUrl,", ").concat(u).concat(c.desktop2xPhotoUrl,' 2x">\n        <img class="article__img" src="').concat(u).concat(c.desktopPhotoUrl,'" alt="').concat(t,'" />\n    </picture>\n    <div class="article__content">\n        ').concat(i,'\n        <div class="article__statistic">\n            <span class="article__post-time">').concat(e,'</span>\n            <span class="article__views">').concat(a,' views</span>\n            <span class="article__comments">').concat(s,' comments</span>\n        </div>\n        <h3 class="article__title">').concat(t,'</h3>\n        <p class="article__text">').concat(n,'</p>\n        <a class="article__link" href="#">Go to this post</a>\n    </div>\n</article>\n    ')}(e)});var c=Math.ceil(t/i.show);document.querySelector(".article-result_js").innerHTML=n;for(var s=0;s<c;s++){var o=document.createElement("li"),r=function(n){var e=document.createElement("a");e.classList.add("pagination__item"),e.classList.add("link_js"),e.innerText=n+1,e.href="?page="+n;var t=h();n===+t.page&&e.classList.add("pagination__item_active");return e.addEventListener("click",function(e){e.preventDefault();var t=document.querySelectorAll(".link_js"),e=new URLSearchParams(location.search);t[h().page].classList.remove("pagination__item_active"),e.set("page",n),t[n].classList.add("pagination__item_active"),history.replaceState(null,document.title,"?"+e.toString()),p(h())}),e}(s);o.appendChild(r),a.insertAdjacentElement("beforeend",o)}m(c),d.classList.add("hidden")}}function h(e){var t=new URLSearchParams(location.search),n=null,e=null,n=t.getAll("tags").length?t.getAll("tags"):["1","6"],e=t.getAll("comments");return{tags:n,views:t.get("views")||"100-500",comments:e,show:t.get("show")||"5",sort:t.get("sort")||"date",search:t.get("search")||"",page:+t.get("page")||0}}(s=new XMLHttpRequest).open("GET",u+"/api/tags"),s.send(),d.classList.remove("hidden"),s.onload=function(){var t,e=JSON.parse(s.response).data,n=document.querySelector(".tags__list");e.forEach(function(e){e=function(e){var t=e.id,n=e.color,e="";e=1===t||6===t?"checked":"";return'\n    <li class="tags__item">\n                            <input type="checkbox" name="tags" id="color-'.concat(t,'" value="').concat(t,'" ').concat(e,'>\n                            <label class="tags__label-').concat(t,'-color" for="color-').concat(t,'"><svg class="tags__check-mark"\n                                    width="15" height="15" viewBox="0 0 15 15" fill="none"\n                                    xmlns="http://www.w3.org/2000/svg">\n                                    <path\n                                        d="M2 6.75L5.91301 12.77C6.20128 13.2135 6.85836 13.1893 7.11327 12.7259L13.425 1.25"\n                                        stroke="').concat(n,'" stroke-width="2.5" stroke-linecap="round" />\n                                </svg></label>\n                        </li>\n    ')}(e);n.insertAdjacentHTML("beforeend",e)}),t=document.forms.filters,function(t){var e=document.forms.filters;e.elements.search.value=t.search,e.elements.tags.forEach(function(e){e.checked=t.tags.includes(e.value)}),e.elements.comments.forEach(function(e){e.checked=t.comments.includes(e.value)}),e.elements.views.forEach(function(e){e.checked=t.views===e.value}),e.elements.show.forEach(function(e){e.checked=t.show===e.value}),e.elements.sort.forEach(function(e){e.checked=t.sort===e.value})}(h()),t.addEventListener("submit",function(e){e.preventDefault();e={page:0};e.search=t.elements.search.value,e.tags=a(t.elements.tags).filter(function(e){return e.checked}).map(function(e){return e.value}),e.comments=a(t.elements.comments).filter(function(e){return e.checked}).map(function(e){return e.value}),e.views=(a(t.elements.views).find(function(e){return e.checked})||{value:null}).value,e.show=(a(t.elements.show).find(function(e){return e.checked})||{value:null}).value,e.sort=(a(t.elements.sort).find(function(e){return e.checked})||{value:null}).value,function(e){var t=new URLSearchParams;t.set("search",e.search),e.tags.forEach(function(e){t.append("tags",e)}),e.comments.forEach(function(e){t.append("comments",e)}),e.views&&t.set("views",e.views);e.show&&t.set("show",e.show);e.sort&&t.set("sort",e.sort);e.page?t.set("page",e.page):t.set("page",0);history.replaceState(null,document.title,"?"+t.toString())}(e),p(e)}),p(h()),d.classList.add("hidden")};